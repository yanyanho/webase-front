webpackJsonp([7],{GBTu:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("P9l9"),n=s("yt7g"),r=s("YaEn"),i=s("Fd2+"),o=localStorage.getItem("assetList")?JSON.parse(localStorage.getItem("assetList")):[],c={name:"orderList",data:function(){return{amount:0,assetObj:null,amountShow:!1,nowTime:(new Date).getTime(),orderList:[],htlcExchangeList:[],userAddress:localStorage.getItem("userAddress"),changeAssetLength:JSON.parse(localStorage.getItem("changeAssetList")).length}},mounted:function(){this.getHtlcExchange()},methods:{link:function(){r.a.push("/inTransaction")},getHtlcExchange:function(t,e){var s=this;Object(a.o)().then(function(t){var e=t.status,a=t.data;200===e?(s.htlcExchangeList=a,s.queryExchangeOrder()):s.$notify({type:"warning",message:t.data.message})}).catch(function(t){s.$notify({type:"danger",message:"系统错误"})})},queryExchangeOrder:function(){for(var t=this,e="",s=0;s<this.htlcExchangeList.length;s++)1==this.htlcExchangeList[s].groupId&&(e=this.htlcExchangeList[s].exchangeContractAddress);var n={userAddress:this.userAddress,groupId:1,exchangeContractAddress:e};Object(a.j)(n).then(function(e){var s=e.status,a=e.data;if(200===s){t.orderList=a.content;for(var n=0;n<t.orderList.length;n++)t.orderList[n].assetGiveMinUnit&&(t.orderList[n].amountGive=t.orderList[n].amountGive/Math.pow(10,t.orderList[n].assetGiveMinUnit)),t.orderList[n].assetGetMinUnit&&(t.orderList[n].amountGet=t.orderList[n].amountGet/Math.pow(10,t.orderList[n].assetGetMinUnit),t.orderList[n].amountGetLeft=t.orderList[n].amountGetLeft/Math.pow(10,t.orderList[n].assetGetMinUnit))}else t.$notify({type:"warning",message:e.data.message})}).catch(function(e){t.$notify({type:"danger",message:"系统错误"})})},trade:function(t){this.assetObj=t,this.amountShow=!0,this.amount=t.amountGet},cancel:function(t){var e=this;i.a.alert({title:"确认取消",message:"取消该订单，订单将会删除"}).then(function(){e.cancelOrder(t)})},cancelOrder:function(t){for(var e=this,s="",n=0;n<this.htlcExchangeList.length;n++)1==this.htlcExchangeList[n].groupId&&(s=this.htlcExchangeList[n].exchangeContractAddress);var r={groupId:1,exchangeContractAddress:s,userAddress:this.userAddress},i={orderHash:t.orderHash};Object(a.e)(r,i).then(function(t){200==t.status?t.data&&(e.queryExchangeOrder(),e.$notify({type:"success",message:"取消成功！"})):e.$notify({type:"warning",message:t.data.message})}).catch(function(t){e.$notify({type:"danger",message:"系统错误"})})},trakeConfirm:function(){var t=this,e="";this.htlcExchangeList.forEach(function(t){"1"==t.groupId&&(e=t.exchangeContractAddress)});var s={userAddress:this.userAddress,groupId:"1",exchangeContractAddress:e},n={orderHash:this.assetObj.orderHash,amount:this.amount,assetGiveMinUnit:this.assetObj.assetGiveMinUnit};Object(a.h)(s,n).then(function(e){t.loading=!1,200==e.status?e.data&&t.queryExchangeOrder():t.$notify({type:"warning",message:e.data.message})}).catch(function(e){t.$notify({type:"danger",message:"系统错误"})})},create:function(){r.a.push("/giveList")}},filters:{Time:function(t){return Object(n.b)(t)},Asset:function(t){for(var e=0;e<o.length;e++)if(o[e].contractAddress==t)return o[e].shortName;return t}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"module"},[s("div",{staticClass:"header"},[s("span",{on:{click:t.link}},[s("van-icon",{attrs:{name:"arrow-left"}}),t._v(" "),s("span",[t._v("返回")])],1)]),t._v(" "),s("ul",t._l(t.orderList,function(e){return s("li",{staticClass:"order-item"},[s("div",{staticClass:"order-item-id"},[t._v(t._s(e.orderHash))]),t._v(" "),s("div",{staticClass:"order-item-user"},[t._v(t._s(e.amountGet)+"("+t._s(t._f("Asset")(e.assetGet))+") ==> "+t._s(e.amountGive)+"("+t._s(t._f("Asset")(e.assetGive))+")")]),t._v(" "),s("div",[t._v(t._s(t._f("Time")(e.expires)))]),t._v(" "),s("div",[e.maker==t.userAddress?s("span",{staticStyle:{color:"#9ACD32"}},[t._v("由我发起")]):s("span",{staticStyle:{color:"#EEAD0E"}},[t._v("他人发起")])]),t._v(" "),s("div",{staticStyle:{margin:"5px 0"}},[e.expires>t.nowTime&&e.maker!=t.userAddress?s("van-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return t.trade(e)}}},[t._v("交易")]):t._e(),t._v(" "),e.maker==t.userAddress?s("van-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return t.cancel(e)}}},[t._v("取消")]):t._e()],1)])}),0),t._v(" "),s("div",{staticClass:"cross-bottom"},[s("van-button",{staticStyle:{width:"100%"},attrs:{type:"default",disabled:!(t.changeAssetLength>0)},on:{click:t.create}},[t._v("创建订单")])],1),t._v(" "),s("van-dialog",{attrs:{title:"取出资产","show-cancel-button":""},on:{confirm:t.trakeConfirm},model:{value:t.amountShow,callback:function(e){t.amountShow=e},expression:"amountShow"}},[s("van-field",{attrs:{required:"",clearable:"",label:"密文",placeholder:"请输入密文"},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}})],1)],1)},staticRenderFns:[]};var u=s("VU/8")(c,d,!1,function(t){s("TGQ6")},"data-v-d5f01008",null);e.default=u.exports},TGQ6:function(t,e){}});